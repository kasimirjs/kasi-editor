
<script>



    let lastAccorionId = 0;

    /**
     *
     * @param elem {HTMLElement}
     */
    function init_akkordion(elem) {
        let id = Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 5);
        console.log("init", elem, id);
        elem.id = id;
    }

    /**
     *
     * @param elem {HTMLElement}
     * @returns {HTMLElement}
     */
    function find_accordion(elem) {
        if (elem.getAttribute("data-ed-id"))
            return elem
        return find_accordion(elem.parentElement)
    }

    function init_accordion_head(elem) {
        lastAccorionId = Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 5);
        elem.setAttribute("aria-controls", lastAccorionId);
        elem.setAttribute("data-bs-target", "#" + lastAccorionId);
    }
    function init_accordion_body(elem) {
        console.log("init", elem);
        elem.setAttribute("aria-labelledby", lastAccorionId);
        elem.setAttribute("data-bs-parent", "#" + find_accordion(elem).id);
        elem.id = lastAccorionId;
    }
/*

    KaEditor.elements.define("bs-accordion", {
        actions: ["move", "delete", ""],
        allow_children: ["bs-*"]
    });

    KaEditor.elements.define("bs-accordion-item", {

    });
*/

</script>

<template data-ed-template>
    <!-- Accordion -->
    <div class="accordion accordion-flush"
         data-ed-id="bs-accordion"
    >
        <div class="accordion-item" data-ed-name="Item" data-ed-repeat="">
            <div class="accordion-header">
                <a class="accordion-button" role="button" data-ed-oninit="init_accordion_head($this)" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    <h3 class="fs-3 m-0" data-ed-text="" data-ed-name="Titel">Akkordion Titel 1</h3>
                </a>
            </div>
            <div  data-ed-name="Content"  class="accordion-collapse collapse show" data-ed-oninit="init_accordion_body($this)" aria-labelledby="headingOne" data-bs-parent="#accordionFAQ">
                <div class="accordion-body">
                    <p data-ed-name="Paragraph" data-ed-text="" data-ed-repeat="">
                        Accordion Text 1
                    </p>
                </div>
            </div>
        </div>
        <!-- End Accordion Item -->
    </div>
</template>

<template data-ed-id="bs-accordion-item">

    <div class="accordion-item" data-ed-name="Item" data-ed-repeat="">
        <div class="accordion-header" id="headingOne">
            <a class="accordion-button" role="button" data-ed-oninit="init_accordion_head($this)" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                <h3 class="fs-3 m-0" data-ed-text="" data-ed-name="Titel">Akkordion Titel 1</h3>
            </a>
        </div>
        <div  data-ed-name="Content"  class="accordion-collapse collapse show" data-ed-oninit="init_accordion_body($this)" aria-labelledby="headingOne" data-bs-parent="#accordionFAQ">
            <div class="accordion-body">
                <p data-ed-name="Paragraph" data-ed-text="" data-ed-repeat="">
                    Accordion Text 1
                </p>
            </div>
        </div>
    </div>
</template>
